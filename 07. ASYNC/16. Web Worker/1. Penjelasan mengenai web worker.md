# ğŸ§µ Thread di JavaScript

## ğŸ“Œ Apa itu Thread?

Thread adalah jalur eksekusi program. Bayangkan thread seperti seorang pekerja yang mengerjakan tugas-tugas dalam program kita.

### ğŸ”‘ Poin Penting tentang Thread di JavaScript

- **JavaScript adalah Single Thread (Single Proses)** 
  
  Artinya walaupun proses yang kita buat adalah Async, tapi tetap akan dijalankan dalam Thread (Proses) yang sama. JavaScript hanya punya **satu pekerja** yang mengerjakan semua tugas secara berurutan.

- **Concurrent (Konkurensi)**
  
  Kemampuan satu Thread dalam mengelola beberapa pekerjaan. Seperti satu orang yang bisa mengerjakan banyak tugas dengan cara bergantian dengan cepat.

- **Parallel (Paralel)**
  
  Kemampuan menjalankan beberapa Thread untuk mengelola satu atau lebih pekerjaan. Seperti memiliki beberapa pekerja yang mengerjakan tugas secara bersamaan.

- **Web Worker = Solusi untuk Paralel**
  
  Dan untuk membuat proses secara Paralel, kita bisa menggunakan **Web Worker**.

---

## ğŸŒ Contoh Masalah: Proses yang Lambat

Mari kita lihat contoh kode yang menunjukkan masalah ketika kita menjalankan proses berat di Main Thread:

### ğŸ“ Kode

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Slow</title>
  </head>
  <body>
    <button id="button-task">Click Me!</button>

    <script>
      const slowLog = (total) => {
        for (let index = 0; index < total; index++) {
          console.log(index);
        }
      };

      document.querySelector('#button-task').addEventListener('click', () => {
        console.log('start');
        slowLog(100000);
        console.log('end');
      });
    </script>
  </body>
</html>
```

### ğŸ’¡ Penjelasan Kode

1. **`slowLog(total)`** - Fungsi yang akan melakukan perulangan sebanyak `total` dan mencetak angka ke console
2. **`console.log('start')`** - Menandai mulainya proses
3. **`slowLog(100000)`** - Menjalankan perulangan 100.000 kali (proses yang berat!)
4. **`console.log('end')`** - Menandai berakhirnya proses

### ğŸ“Š Output

```
start
0
1
2
3
...
99997
99998
99999
end
```

### âš ï¸ Masalah yang Terjadi

Ketika tombol diklik, browser akan **FREEZE** (membeku) karena JavaScript harus menunggu perulangan 100.000 kali selesai! Selama proses ini, user tidak bisa melakukan apa-apa. Ini pengalaman yang buruk! ğŸ˜°

---

## ğŸŒ Web Worker: Solusi untuk Proses Berat

### ğŸ¯ Apa itu Web Worker?

- **Web Worker** adalah kemampuan yang untuk menjalankan proses di **Thread yang berbeda** dibanding Main Thread.

### âœ¨ Keuntungan Web Worker

- Jika terdapat proses yang **membutuhkan waktu lama**, Web kita **tidak akan Freeze**! 
- Kenapa? Karena proses tersebut bisa kita jalankan di Thread yang berbeda dari Main Thread (yang biasa digunakan oleh UI)
- User tetap bisa berinteraksi dengan website sementara proses berat berjalan di background! ğŸ‰

### ğŸ“š Dokumentasi Resmi

- ğŸ”— https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API

---

## ğŸ“Š Diagram Web Worker

Berikut adalah cara Main Thread dan Web Worker Thread berkomunikasi:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Main Thread â”‚    â”‚ Web Worker Thread  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                  â”‚
       â”‚  Post Message    â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                  â”‚
       â”‚  Show Header     â”‚
       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                  â”‚
       â”‚                  â”‚  Do Work
       â”‚                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                  â”‚         â”‚
       â”‚  Show Footer     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                  â”‚
       â”‚  Post Message    â”‚
       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Main Thread â”‚    â”‚ Web Worker Thread  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ” Penjelasan Diagram

1. **Main Thread** mengirim pesan ke **Web Worker Thread** dengan `postMessage()`
2. **Web Worker** menerima pesan dan mulai bekerja
3. Selama bekerja, **Web Worker** bisa mengirim update ke **Main Thread**
4. **Main Thread** tetap bisa merespon user (tidak freeze!)
5. Setelah selesai, **Web Worker** mengirim hasil akhir ke **Main Thread**

---

## ğŸ‘· Cara Menggunakan Worker

### ğŸ› ï¸ Membuat Object Worker

- Untuk menggunakan Web Worker API, kita bisa membuat object **Worker**
- ğŸ”— https://developer.mozilla.org/en-US/docs/Web/API/Worker

### ğŸ“¨ Mengirim Pesan ke Worker

- Worker tidak akan secara otomatis berjalan
- Kita perlu memberi perintah dengan cara **mengirim pesan**
- Gunakan method `postMessage()` untuk mengirim pesan

### ğŸ“¬ Menerima Balasan dari Worker

- Untuk menerima balasan dari worker, gunakan event listener `onmessage`
- Data yang diterima adalah object **MessageEvent**
- ğŸ”— https://developer.mozilla.org/en-US/docs/Web/API/MessageEvent

---

## ğŸš€ Contoh Implementasi Web Worker

Mari kita perbaiki contoh sebelumnya menggunakan Web Worker!

### ğŸ“ File: index.html

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Web Worker</title>
  </head>
  <body>
    <button id="button-task">Click Me!</button>

    <script>
      const worker = new Worker('worker.js');

      worker.addEventListener('message', (message) => {
        console.log(message.data);
      });

      document.querySelector('#button-task').addEventListener('click', () => {
        worker.postMessage(100000);
      });
    </script>
  </body>
</html>
```

### ğŸ’¡ Penjelasan Kode index.html

1. **`new Worker('worker.js')`** - Membuat worker baru yang akan menjalankan kode dari file `worker.js`
2. **`worker.addEventListener('message', ...)`** - Mendengarkan pesan yang dikirim dari worker
3. **`message.data`** - Data yang dikirim dari worker
4. **`worker.postMessage(100000)`** - Mengirim angka 100000 ke worker untuk diproses

---

### ğŸ“ File: worker.js

```javascript
addEventListener('message', (message) => {
  const total = message.data;

  for (let index = 0; index < total; index++) {
    postMessage(index);
  }
});
```

### ğŸ’¡ Penjelasan Kode worker.js

1. **`addEventListener('message', ...)`** - Mendengarkan pesan dari Main Thread
2. **`message.data`** - Mengambil data yang dikirim (dalam hal ini angka 100000)
3. **Loop `for`** - Melakukan perulangan sebanyak `total`
4. **`postMessage(index)`** - Mengirim setiap angka kembali ke Main Thread

---

### ğŸ“Š Output

```
0
1
2
3
4
5
...
99995
99996
99997
99998
99999
```

### ğŸ‰ Perbedaan dengan Versi Sebelumnya

- **Website tidak freeze!** Browser tetap responsif! âœ¨
- User bisa scroll, klik button lain, atau melakukan interaksi lainnya
- Proses berat berjalan di **background** (Web Worker Thread)
- Main Thread tetap **bebas** untuk menangani UI

---

## ğŸ¯ Kapan Menggunakan Web Worker?

### âœ… Gunakan Web Worker untuk:

- ğŸ”¢ Kalkulasi matematika yang kompleks
- ğŸ“Š Pemrosesan data besar
- ğŸ–¼ï¸ Manipulasi gambar
- ğŸ” Enkripsi/dekripsi data
- ğŸ“ˆ Analisis data

### âŒ Jangan gunakan Web Worker untuk:

- ğŸ–±ï¸ Manipulasi DOM (Web Worker tidak punya akses ke DOM!)
- âš¡ Operasi yang cepat dan ringan
- ğŸ¨ Mengubah tampilan UI secara langsung

---

## ğŸ“ Rangkuman

1. **JavaScript adalah Single Thread** - hanya punya 1 pekerja
2. **Proses berat di Main Thread = Website Freeze** ğŸ¥¶
3. **Web Worker = Pekerja tambahan** yang bekerja di thread terpisah
4. **Komunikasi dengan `postMessage()`** dan **`addEventListener('message')`**
5. **Hasil: Website tetap responsif** saat proses berat berjalan! ğŸ‰

---

## ğŸ”— Referensi Lebih Lanjut

- ğŸ“– [Web Workers API - MDN](https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API)
- ğŸ“– [Worker - MDN](https://developer.mozilla.org/en-US/docs/Web/API/Worker)
- ğŸ“– [MessageEvent - MDN](https://developer.mozilla.org/en-US/docs/Web/API/MessageEvent)

---

**Selamat belajar! ğŸš€ Happy Coding! ğŸ’»**
