# ğŸ­ Proxy

- ğŸ¯ Proxy merupakan fitur yang bisa digunakan sebagai **wakil sebuah data**
- ğŸ”„ Dengan menggunakan proxy, semua interaksi ke data akan selalu melalui **Proxy terlebih dahulu**
- âš¡ Dengan ini, kita bisa melakukan **apapun sebelum interaksi dilakukan** ke data yang dituju
- ğŸ“š https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy

---

## ğŸ¯ Proxy Handler

- Pembuatan Proxy perlu menggunakan handler, dimana dalam handler, kita bisa membuat function yang dinamakan interceptor yang digunakan ketika mengambil data atau mengubah data ke target
- Untuk membuat Proxy, kita bisa menggunakan new Proxy(target, handler)

### ğŸ“ Contoh Kode Proxy Handler

```javascript
const target = {
  name: "Budi",
  age: 25
};

const handler = {
  get: function(target, property) {
    console.log(`Mengambil property: ${property}`);
    return target[property];
  },
  set: function(target, property, value) {
    console.log(`Mengubah property: ${property} menjadi ${value}`);
    target[property] = value;
    return true;
  }
};

const proxy = new Proxy(target, handler);

// Mengambil data
console.log(proxy.name);
// Output:
// Mengambil property: name
// Budi

// Mengubah data
proxy.age = 30;
// Output:
// Mengubah property: age menjadi 30
```

**ğŸ’¡ Penjelasan:**
- `target` adalah object asli yang ingin kita buat proxy-nya
- `handler` berisi function-function interceptor (`get` dan `set`)
- Setiap kali kita mengakses atau mengubah property pada `proxy`, handler akan dipanggil terlebih dahulu
- Function `get` dipanggil saat mengambil data, function `set` dipanggil saat mengubah data

---

## ğŸ”„ Proxy dan Handler

- Saat kita mengubah data proxy, secara otomatis data akan dikirim ke target melalui handler dengan memanggil function set(target, property, value)
- Saat kita mengambil data proxy, secara otomatis data akan diambil dari target melalui handler dengan memanggil function get(target, property)
- Artinya, jika kita ingin melakukan sesuatu sebelum dan setelah nya, bisa kita lakukan di handler

### ğŸ“ Contoh Kode Proxy dan Handler Lengkap

```javascript
const mahasiswa = {
  nama: "Andi",
  nilai: 85
};

const handlerMahasiswa = {
  get: function(target, property) {
    if (property === "nilai") {
      console.log(`âœ… Akses nilai: ${target[property]}`);
      return target[property];
    }
    console.log(`ğŸ“– Membaca property: ${property}`);
    return target[property];
  },
  
  set: function(target, property, value) {
    if (property === "nilai") {
      if (value < 0 || value > 100) {
        console.log(`âŒ Nilai harus antara 0-100!`);
        return false;
      }
      console.log(`âœï¸ Mengubah nilai dari ${target[property]} ke ${value}`);
    }
    target[property] = value;
    return true;
  }
};

const proxyMahasiswa = new Proxy(mahasiswa, handlerMahasiswa);

// Mengambil data
console.log(proxyMahasiswa.nama);
// Output:
// ğŸ“– Membaca property: nama
// Andi

console.log(proxyMahasiswa.nilai);
// Output:
// âœ… Akses nilai: 85
// 85

// Mengubah data valid
proxyMahasiswa.nilai = 90;
// Output:
// âœï¸ Mengubah nilai dari 85 ke 90

console.log(proxyMahasiswa.nilai);
// Output:
// âœ… Akses nilai: 90
// 90

// Mengubah data tidak valid
proxyMahasiswa.nilai = 150;
// Output:
// âŒ Nilai harus antara 0-100!

console.log(proxyMahasiswa.nilai);
// Output:
// âœ… Akses nilai: 90
// 90
```

**ğŸ’¡ Penjelasan:**
- Handler dapat digunakan untuk **validasi data** sebelum mengubah target
- Function `get` memberikan informasi setiap kali property diakses
- Function `set` dapat menolak perubahan dengan return `false` jika data tidak valid
- `return true` menandakan bahwa operasi set berhasil dilakukan
- Semua operasi melalui proxy akan melewati handler terlebih dahulu sebelum mencapai target
- Ini membuat kita bisa mengontrol akses dan modifikasi data dengan lebih baik

---

### ğŸ“ Contoh Kode Tanpa Return True (Implicit)

```javascript
const produk = {
  nama: "Laptop",
  harga: 5000000,
  stok: 10
};

const handlerProduk = {
  get: function(target, property) {
    console.log(`ğŸ” Mengakses property: ${property}`);
    return target[property];
  },
  
  set: function(target, property, value) {
    console.log(`ğŸ“ Mencoba mengubah ${property} menjadi ${value}`);
    
    if (property === "harga" && value < 0) {
      console.log(`â›” Harga tidak boleh negatif!`);
      return false;
    }
    
    if (property === "stok" && value < 0) {
      console.log(`â›” Stok tidak boleh negatif!`);
      return false;
    }
    
    target[property] = value;
    console.log(`âœ… Berhasil mengubah ${property}`);
    // Tidak perlu return true, secara default akan return undefined
    // JavaScript akan menganggapnya sebagai operasi yang berhasil
  }
};

const proxyProduk = new Proxy(produk, handlerProduk);

// Mengambil data
console.log(proxyProduk.nama);
// Output:
// ğŸ” Mengakses property: nama
// Laptop

// Mengubah data valid (tanpa return true)
proxyProduk.harga = 4500000;
// Output:
// ğŸ“ Mencoba mengubah harga menjadi 4500000
// âœ… Berhasil mengubah harga

console.log(proxyProduk.harga);
// Output:
// ğŸ” Mengakses property: harga
// 4500000

// Mengubah data valid untuk stok
proxyProduk.stok = 15;
// Output:
// ğŸ“ Mencoba mengubah stok menjadi 15
// âœ… Berhasil mengubah stok

// Mengubah data tidak valid
proxyProduk.harga = -1000;
// Output:
// ğŸ“ Mencoba mengubah harga menjadi -1000
// â›” Harga tidak boleh negatif!

console.log(proxyProduk.harga);
// Output:
// ğŸ” Mengakses property: harga
// 4500000
```

**ğŸ’¡ Penjelasan:**
- Function `set` **tidak harus** menggunakan `return true` secara eksplisit
- Jika kita tidak mereturn apa-apa, JavaScript akan menganggap operasi berhasil (return `undefined` dianggap truthy dalam konteks ini)
- Namun, jika operasi gagal, kita **harus** `return false` untuk menolak perubahan
- Best practice: tetap gunakan `return true` untuk kejelasan kode
- Tanpa return statement, kode tetap berfungsi normal untuk operasi yang berhasil
- Contoh ini menunjukkan validasi untuk multiple property (harga dan stok)

**ğŸ” Penjelasan Kode `target[property] = value;`:**
- Baris `target[property] = value;` adalah operasi **assignment** (penugasan nilai) ke object target
- Ini **bukan** statement return, melainkan operasi untuk **mengubah nilai** property pada object target
- Setelah baris ini dieksekusi, nilai pada target sudah berubah
- Statement ini **harus ada** untuk benar-benar menyimpan nilai baru ke target object
- Kemudian baru kita bisa memutuskan apakah perlu `return true` atau tidak
- Tanpa baris ini, nilai pada proxy tidak akan tersimpan ke target object yang sebenarnya
- **Penting:** `target[property] = value;` adalah untuk **menyimpan data**, sedangkan `return true/false` adalah untuk **memberitahu JavaScript** apakah operasi set berhasil atau gagal

---

### ğŸ¨ Keuntungan Menggunakan Proxy:
- âœ… **Validasi otomatis** - Bisa memvalidasi data sebelum disimpan
- âœ… **Logging** - Bisa mencatat setiap akses atau perubahan data
- âœ… **Kontrol akses** - Bisa membatasi akses ke property tertentu
- âœ… **Reaktivitas** - Bisa membuat sistem reaktif seperti di framework modern
